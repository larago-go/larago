import{Fragment as K,computed as u,defineComponent as G,h as L,inject as M,onMounted as A,onUnmounted as _,provide as $,ref as h,toRaw as v,watch as U}from"vue";import{dom as F}from'../../utils/dom.js';import{Keys as y}from'../../keyboard.js';import{focusIn as C,Focus as O,FocusResult as D,sortByDomNode as W}from'../../utils/focus-management.js';import{useId as x}from'../../hooks/use-id.js';import{compact as J,omit as q,render as I}from'../../utils/render.js';import{Label as Q,useLabels as P}from'../label/label.js';import{Description as X,useDescriptions as B}from'../description/description.js';import{useTreeWalker as Y}from'../../hooks/use-tree-walker.js';import{Hidden as Z,Features as z}from'../../internal/hidden.js';import{attemptSubmit as ee,objectToFormEntries as te}from'../../utils/form.js';import{getOwnerDocument as T}from'../../utils/owner.js';import{useControllable as ae}from'../../hooks/use-controllable.js';function ne(t,m){return t===m}let V=Symbol("RadioGroupContext");function j(t){let m=M(V,null);if(m===null){let o=new Error(`<${t} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,j),o}return m}let Oe=G({name:"RadioGroup",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"div"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>ne},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},name:{type:String,optional:!0},id:{type:String,default:()=>`headlessui-radiogroup-${x()}`}},inheritAttrs:!1,setup(t,{emit:m,attrs:o,slots:k,expose:d}){let s=h(null),i=h([]),b=P({name:"RadioGroupLabel"}),E=B({name:"RadioGroupDescription"});d({el:s,$el:s});let[f,w]=ae(u(()=>t.modelValue),e=>m("update:modelValue",e),u(()=>t.defaultValue)),l={options:i,value:f,disabled:u(()=>t.disabled),firstOption:u(()=>i.value.find(e=>!e.propsRef.disabled)),containsCheckedOption:u(()=>i.value.some(e=>l.compare(v(e.propsRef.value),v(t.modelValue)))),compare(e,a){if(typeof t.by=="string"){let n=t.by;return(e==null?void 0:e[n])===(a==null?void 0:a[n])}return t.by(e,a)},change(e){var n;if(t.disabled||l.compare(v(f.value),v(e)))return!1;let a=(n=i.value.find(r=>l.compare(v(r.propsRef.value),v(e))))==null?void 0:n.propsRef;return a!=null&&a.disabled?!1:(w(e),!0)},registerOption(e){i.value.push(e),i.value=W(i.value,a=>a.element)},unregisterOption(e){let a=i.value.findIndex(n=>n.id===e);a!==-1&&i.value.splice(a,1)}};$(V,l),Y({container:u(()=>F(s)),accept(e){return e.getAttribute("role")==="radio"?NodeFilter.FILTER_REJECT:e.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(e){e.setAttribute("role","none")}});function g(e){if(!s.value||!s.value.contains(e.target))return;let a=i.value.filter(n=>n.propsRef.disabled===!1).map(n=>n.element);switch(e.key){case y.Enter:ee(e.currentTarget);break;case y.ArrowLeft:case y.ArrowUp:if(e.preventDefault(),e.stopPropagation(),C(a,O.Previous|O.WrapAround)===D.Success){let r=i.value.find(p=>{var c;return p.element===((c=T(s))==null?void 0:c.activeElement)});r&&l.change(r.propsRef.value)}break;case y.ArrowRight:case y.ArrowDown:if(e.preventDefault(),e.stopPropagation(),C(a,O.Next|O.WrapAround)===D.Success){let r=i.value.find(p=>{var c;return p.element===((c=T(p.element))==null?void 0:c.activeElement)});r&&l.change(r.propsRef.value)}break;case y.Space:{e.preventDefault(),e.stopPropagation();let n=i.value.find(r=>{var p;return r.element===((p=T(r.element))==null?void 0:p.activeElement)});n&&l.change(n.propsRef.value)}break}}let R=u(()=>{var e;return(e=F(s))==null?void 0:e.closest("form")});return A(()=>{U([R],()=>{if(!R.value||t.defaultValue===void 0)return;function e(){l.change(t.defaultValue)}return R.value.addEventListener("reset",e),()=>{var a;(a=R.value)==null||a.removeEventListener("reset",e)}},{immediate:!0})}),()=>{let{disabled:e,name:a,id:n,...r}=t,p={ref:s,id:n,role:"radiogroup","aria-labelledby":b.value,"aria-describedby":E.value,onKeydown:g};return L(K,[...a!=null&&f.value!=null?te({[a]:f.value}).map(([c,S])=>L(Z,J({features:z.Hidden,key:c,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:c,value:S}))):[],I({ourProps:p,theirProps:{...o,...q(r,["modelValue","defaultValue"])},slot:{},attrs:o,slots:k,name:"RadioGroup"})])}}});var re=(o=>(o[o.Empty=1]="Empty",o[o.Active=2]="Active",o))(re||{});let ke=G({name:"RadioGroupOption",props:{as:{type:[Object,String],default:"div"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:()=>`headlessui-radiogroup-option-${x()}`}},setup(t,{attrs:m,slots:o,expose:k}){let d=j("RadioGroupOption"),s=P({name:"RadioGroupLabel"}),i=B({name:"RadioGroupDescription"}),b=h(null),E=u(()=>({value:t.value,disabled:t.disabled})),f=h(1);k({el:b,$el:b}),A(()=>d.registerOption({id:t.id,element:b,propsRef:E})),_(()=>d.unregisterOption(t.id));let w=u(()=>{var r;return((r=d.firstOption.value)==null?void 0:r.id)===t.id}),l=u(()=>d.disabled.value||t.disabled),g=u(()=>d.compare(v(d.value.value),v(t.value))),R=u(()=>l.value?-1:g.value||!d.containsCheckedOption.value&&w.value?0:-1);function e(){var r;!d.change(t.value)||(f.value|=2,(r=b.value)==null||r.focus())}function a(){f.value|=2}function n(){f.value&=-3}return()=>{let{id:r,value:p,disabled:c,...S}=t,H={checked:g.value,disabled:l.value,active:Boolean(f.value&2)},N={id:r,ref:b,role:"radio","aria-checked":g.value?"true":"false","aria-labelledby":s.value,"aria-describedby":i.value,"aria-disabled":l.value?!0:void 0,tabIndex:R.value,onClick:l.value?void 0:e,onFocus:l.value?void 0:a,onBlur:l.value?void 0:n};return I({ourProps:N,theirProps:S,slot:H,attrs:m,slots:o,name:"RadioGroupOption"})}}}),Ee=Q,we=X;export{Oe as RadioGroup,we as RadioGroupDescription,Ee as RadioGroupLabel,ke as RadioGroupOption};
